{"componentChunkName":"component---src-templates-course-content-template-js","path":"/part-0/5-pod","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"h4","properties":{"id":"what-is-a-pod","style":"position:relative;"},"children":[{"type":"text","value":"What is a Pod?"},{"type":"element","tagName":"a","properties":{"href":"#what-is-a-pod","ariaLabel":"what is a pod permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Pod"}]},{"type":"text","value":" is an abstraction around one or more containers. Pods provide a context for 1..N containers so that they can share storage and a network. It's very much like how you have used containers to define environments for a single process. They can be thought of as a container of containers. "},{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Most"}]},{"type":"text","value":" of the same rules apply: it is deleted if the containers within stop running and contained files will be lost with it."}]},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 731px; margin-bottom: 1rem;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"a","properties":{"className":["gatsby-resp-image-link"],"href":"/static/44b180d0bf8c0d75212b5e04fdb8f487/6e9ba/pods.png","style":"display: block","target":"_blank","rel":["noopener"]},"children":[{"type":"text","value":"\n    "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 24.782608695652172%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVR42i1QyW6FMAzMp/bSP3mHqmp761fBFTjwKEjsO2IXebHribAUZWKPxxOrMAxpHEfuuo76vueyLLltWxZMknsBJ0ny5rrud1EUqGlwka+qCjxumsbgjqLoT2VZxtM00bIsPM8zsD3AktPHcfC+75++7//IzRL6PE8riAHbtrExBnnCW8l0E8exdVTXNV3XZYl5nsOhxmRpenie94VmCIIndTsYwjKUUJA+o/BFKZhhGBgHgUYIQRAOtdYPcfiLYRBEDmLgr+vKRFbPulZPCWmEgMFubsz3jX1xmqYfjuO8w7mIvPCbe8+WJ5iwoiAI6B+ucXO6gbf/gAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"picture","properties":{},"children":[{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/44b180d0bf8c0d75212b5e04fdb8f487/a0b58/pods.webp 230w","/static/44b180d0bf8c0d75212b5e04fdb8f487/bc10c/pods.webp 460w","/static/44b180d0bf8c0d75212b5e04fdb8f487/feeb6/pods.webp 731w"],"sizes":["(max-width:","731px)","100vw,","731px"],"type":"image/webp"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"source","properties":{"srcSet":["/static/44b180d0bf8c0d75212b5e04fdb8f487/81c8e/pods.png 230w","/static/44b180d0bf8c0d75212b5e04fdb8f487/08a84/pods.png 460w","/static/44b180d0bf8c0d75212b5e04fdb8f487/6e9ba/pods.png 731w"],"sizes":["(max-width:","731px)","100vw,","731px"],"type":"image/png"},"children":[]},{"type":"text","value":"\n        "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"src":"/static/44b180d0bf8c0d75212b5e04fdb8f487/6e9ba/pods.png","alt":"pods","title":"pods","loading":"lazy","style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"},"children":[]},{"type":"text","value":"\n      "}]},{"type":"text","value":"\n  "}]},{"type":"text","value":"\n    "}]},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Or as "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"kubectl explain pod"}]},{"type":"text","value":" says"}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"DESCRIPTION:\n     Pod is a collection of containers that can run on a host. This resource is\n     created by clients and scheduled onto hosts.\n"}]},{"type":"element","tagName":"exercise","properties":{"name":"first pod"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"See what happens when"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl create pod"}]}]}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"Error: must specify one of -f and -k\n\nerror: unknown command \"pod\"\nSee 'kubectl create -h' for help and examples\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"kubectl create can not create pods (!)"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"try with"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl run whoami --image jwilder/whoami"}]}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get pod"}]}]}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"pod fields"},"children":[{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"NAME     READY   STATUS    RESTARTS   AGE\nwhoami   1/1     Running   0          33s\n"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"1/1"}]},{"type":"text","value":" READY means that 1 out of the 1 containers is ready."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"has restarted 0 times"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We'll soon create pods with multiple containers."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"Where did it land?"},"children":[{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get pod -o wide"}]}]}]}]},{"type":"element","tagName":"exercise","properties":{"name":"describe pod vs lens"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Describe the newly created pod"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl ? ?"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And then in Lens, select Workloads (from the left) and then Pods."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Then set the namespace in the namespace selector. Notice how you can type in the selector."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And then \"describe in lens\""}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Also, check how you can click access the node from Lens describe pane by clicking it."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lens \"bug\": "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/lensapp/lens/issues/6739","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/lensapp/lens/issues/6739"}]}]}]},{"type":"element","tagName":"exercise","properties":{"name":"get events"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Notice how at the end of the describe there are \"events\" - they come from "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"events"}]},{"type":"text","value":" resource."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Get all events in the cluster"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get events"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Get events scoped by "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"-n"}]},{"type":"text","value":"amespace"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get events -n __NAME__"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Notice how event timestamps are sorted by random, "},{"type":"element","tagName":"a","properties":{"href":"https://stackoverflow.com/questions/45226732/what-kubectl-command-can-i-use-to-get-events-sorted-by-specific-fields-and-print","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://stackoverflow.com/questions/45226732/what-kubectl-command-can-i-use-to-get-events-sorted-by-specific-fields-and-print"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Find \"Events\" from the lens and do the same listing of cluster wide and scoped."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"kubectl logs"},"children":[{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl logs whoami"}]}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl logs -f whoami"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And then same with Lens."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"kubectl exec"},"children":[{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl exec -it whoami -- bash"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Fails, why? How to fix it?"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And then same with Lens."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"kubectl port-forward"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Output shows listen :8000"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl port-forward pod/whoami 9999:8000"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Try from own machine "},{"type":"element","tagName":"a","properties":{"href":"http://localhost:9999","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"http://localhost:9999"}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The same can not be done, yet, with Lens."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"Change the image"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"img","properties":{"src":"https://media.tenor.com/eqLNYv0A9TQAAAAC/swap-indiana-jones.gif"},"children":[]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This makes no sense, but is fun."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Change the image from "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"jwilder/whoami"}]},{"type":"text","value":" to "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"nginx"}]},{"type":"text","value":" with"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl set image pod whoami whoami=nginx"}]}]}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"See how restart count changes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Check events"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Check logs"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Run port-forward - note that nginx container port is 80, not 8000"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl logs --previous whoami"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And same in Lens"}]}]},{"type":"element","tagName":"exercise","properties":{"name":"kubectl cp"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Create an "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"index.html"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"echo \"hello\" > index.html"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"and copy it to the container ("},{"type":"element","tagName":"a","properties":{"href":"https://hub.docker.com/_/nginx","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://hub.docker.com/_/nginx"}]},{"type":"text","value":")"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl cp index.html whoami:/usr/share/nginx/html/index.html"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Try reloading "},{"type":"element","tagName":"a","properties":{"href":"http://localhost:9999","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"http://localhost:9999"}]},{"type":"text","value":" (hard)"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Note, "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"cp"}]},{"type":"text","value":" works both ways"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl cp whoami:/etc/passwd passwd"}]}]}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"try adding another container"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Let's test"}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"kubectl edit"},"children":[{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"$ EDITOR=nano kubectl edit pod whoami\n..."}]}]}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"node shell"},"children":[{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl run another --image nginx"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Delete the container from the node and check restart count."}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"save pod"},"children":[{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get pod whoami -o yaml > whoami.yml"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://github.com/itaysk/kubectl-neat","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/itaysk/kubectl-neat"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get pod whoami -o yaml | kubectl neat > whoami.yml"}]}]}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"node drain"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Drain a node"}]}]},{"type":"element","tagName":"exercise","properties":{"name":"cleanup"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Delete the namespace to clean up"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl delete namespace __NAME__"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Notice how get pod listing still \"uses\" the namespace"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get pod"}]}]}]},{"type":"element","tagName":"pre","properties":{},"children":[{"type":"text","value":"No resources found in __NAME__ namespace.\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You need to reset the namespace back to default"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl config set-context --current --namespace=default"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Will "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"get pod"}]},{"type":"text","value":" now list default namespace?"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"see "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/blendle/kns","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/blendle/kns"}]},{"type":"text","value":" and "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/ahmetb/kubectx","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://github.com/ahmetb/kubectx"}]}]}]},{"type":"element","tagName":"exercise","properties":{"name":"try delete namespace default"},"children":[{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl delete ns default"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"What happens?"}]}]},{"type":"element","tagName":"exercise","properties":{"name":"plenty of other pods"},"children":[{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get pod --all-namespaces"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"or"}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get pod -A"}]}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get pod --namespace kube-system"}]}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"kubectl get pod -n kube-system"}]}]}]}]},{"type":"element","tagName":"summary","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"pod is ~immutable unit of container orchestration"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl run"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl get events"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl logs [—previous]"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl exec"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl port-forward"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl set image"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl cp"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl delete"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl -A | —all-namespaces"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"kubectl -n | —namespace"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/reference/kubectl/docker-cli-to-kubectl/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://kubernetes.io/docs/reference/kubectl/docker-cli-to-kubectl/"}]}]}]}]},"html":"<div><h4 id=\"what-is-a-pod\" style=\"position:relative;\">What is a Pod?<a href=\"#what-is-a-pod\" aria-label=\"what is a pod permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4><p><em>Pod</em> is an abstraction around one or more containers. Pods provide a context for 1..N containers so that they can share storage and a network. It's very much like how you have used containers to define environments for a single process. They can be thought of as a container of containers. <em>Most</em> of the same rules apply: it is deleted if the containers within stop running and contained files will be lost with it.</p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 731px; margin-bottom: 1rem;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/44b180d0bf8c0d75212b5e04fdb8f487/6e9ba/pods.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 24.782608695652172%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVR42i1QyW6FMAzMp/bSP3mHqmp761fBFTjwKEjsO2IXebHribAUZWKPxxOrMAxpHEfuuo76vueyLLltWxZMknsBJ0ny5rrud1EUqGlwka+qCjxumsbgjqLoT2VZxtM00bIsPM8zsD3AktPHcfC+75++7//IzRL6PE8riAHbtrExBnnCW8l0E8exdVTXNV3XZYl5nsOhxmRpenie94VmCIIndTsYwjKUUJA+o/BFKZhhGBgHgUYIQRAOtdYPcfiLYRBEDmLgr+vKRFbPulZPCWmEgMFubsz3jX1xmqYfjuO8w7mIvPCbe8+WJ5iwoiAI6B+ucXO6gbf/gAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <picture>\n        <source srcset=\"/static/44b180d0bf8c0d75212b5e04fdb8f487/a0b58/pods.webp 230w,\n/static/44b180d0bf8c0d75212b5e04fdb8f487/bc10c/pods.webp 460w,\n/static/44b180d0bf8c0d75212b5e04fdb8f487/feeb6/pods.webp 731w\" sizes=\"(max-width: 731px) 100vw, 731px\" type=\"image/webp\">\n        <source srcset=\"/static/44b180d0bf8c0d75212b5e04fdb8f487/81c8e/pods.png 230w,\n/static/44b180d0bf8c0d75212b5e04fdb8f487/08a84/pods.png 460w,\n/static/44b180d0bf8c0d75212b5e04fdb8f487/6e9ba/pods.png 731w\" sizes=\"(max-width: 731px) 100vw, 731px\" type=\"image/png\">\n        <img class=\"gatsby-resp-image-image\" src=\"/static/44b180d0bf8c0d75212b5e04fdb8f487/6e9ba/pods.png\" alt=\"pods\" title=\"pods\" loading=\"lazy\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n      </picture>\n  </a>\n    </span><br><p>Or as <code class=\"language-text\">kubectl explain pod</code> says</p><pre>\nDESCRIPTION:\n     Pod is a collection of containers that can run on a host. This resource is\n     created by clients and scheduled onto hosts.\n</pre><exercise name='first pod'><p>See what happens when</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl create pod</code></pre></div><pre>\nError: must specify one of -f and -k\n\nerror: unknown command \"pod\"\nSee 'kubectl create -h' for help and examples\n</pre><p>kubectl create can not create pods (!)</p><p>try with</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl run whoami --image jwilder/whoami</code></pre></div><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get pod</code></pre></div></exercise><text-box variant='learningObjectives' name='pod fields'><pre>\nNAME     READY   STATUS    RESTARTS   AGE\nwhoami   1/1     Running   0          33s\n</pre><ul>\n<li><code class=\"language-text\">1/1</code> READY means that 1 out of the 1 containers is ready.</li>\n<li>has restarted 0 times</li>\n</ul><p>We'll soon create pods with multiple containers.</p></text-box><exercise name='Where did it land?'><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get pod -o wide</code></pre></div></exercise><exercise name='describe pod vs lens'><p>Describe the newly created pod</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl ? ?</code></pre></div><p>And then in Lens, select Workloads (from the left) and then Pods.</p><p>Then set the namespace in the namespace selector. Notice how you can type in the selector.</p><p>And then \"describe in lens\"</p><p>Also, check how you can click access the node from Lens describe pane by clicking it.</p><p>Lens \"bug\": <a href=\"https://github.com/lensapp/lens/issues/6739\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/lensapp/lens/issues/6739</a></p></exercise><exercise name='get events'><p>Notice how at the end of the describe there are \"events\" - they come from <code class=\"language-text\">events</code> resource.</p><p>Get all events in the cluster</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get events</code></pre></div><p>Get events scoped by <code class=\"language-text\">-n</code>amespace</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get events -n __NAME__</code></pre></div><p>Notice how event timestamps are sorted by random, <a href=\"https://stackoverflow.com/questions/45226732/what-kubectl-command-can-i-use-to-get-events-sorted-by-specific-fields-and-print\" target=\"_blank\" rel=\"noopener noreferrer\">https://stackoverflow.com/questions/45226732/what-kubectl-command-can-i-use-to-get-events-sorted-by-specific-fields-and-print</a></p><p>Find \"Events\" from the lens and do the same listing of cluster wide and scoped.</p></exercise><exercise name='kubectl logs'><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl logs whoami</code></pre></div><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl logs -f whoami</code></pre></div><p>And then same with Lens.</p></exercise><exercise name='kubectl exec'><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl exec -it whoami -- bash</code></pre></div><p>Fails, why? How to fix it?</p><p>And then same with Lens.</p></exercise><exercise name='kubectl port-forward'><p>Output shows listen :8000</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl port-forward pod/whoami 9999:8000</code></pre></div><p>Try from own machine <a href=\"http://localhost:9999\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:9999</a></p><p>The same can not be done, yet, with Lens.</p></exercise><exercise name='Change the image'><p><img src=\"https://media.tenor.com/eqLNYv0A9TQAAAAC/swap-indiana-jones.gif\"></p><p>This makes no sense, but is fun.</p><p>Change the image from <code class=\"language-text\">jwilder/whoami</code> to <code class=\"language-text\">nginx</code> with</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl set image pod whoami whoami=nginx</code></pre></div><ul>\n<li>See how restart count changes</li>\n<li>Check events</li>\n<li>Check logs</li>\n<li>Run port-forward - note that nginx container port is 80, not 8000</li>\n</ul><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl logs --previous whoami</code></pre></div><p>And same in Lens</p></exercise><exercise name='kubectl cp'><p>Create an <code class=\"language-text\">index.html</code></p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">echo &quot;hello&quot; &gt; index.html</code></pre></div><p>and copy it to the container (<a href=\"https://hub.docker.com/_/nginx\" target=\"_blank\" rel=\"noopener noreferrer\">https://hub.docker.com/_/nginx</a>)</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl cp index.html whoami:/usr/share/nginx/html/index.html</code></pre></div><p>Try reloading <a href=\"http://localhost:9999\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:9999</a> (hard)</p><p>Note, <code class=\"language-text\">cp</code> works both ways</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl cp whoami:/etc/passwd passwd</code></pre></div></exercise><text-box variant='learningObjectives' name='try adding another container'><p>Let's test</p></text-box><text-box variant='learningObjectives' name='kubectl edit'><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">$ EDITOR=nano kubectl edit pod whoami\n...</code></pre></div></text-box><text-box variant='learningObjectives' name='node shell'><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl run another --image nginx</code></pre></div><p>Delete the container from the node and check restart count.</p></text-box><text-box variant='learningObjectives' name='save pod'><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get pod whoami -o yaml &gt; whoami.yml</code></pre></div><p><a href=\"https://github.com/itaysk/kubectl-neat\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/itaysk/kubectl-neat</a></p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get pod whoami -o yaml | kubectl neat &gt; whoami.yml</code></pre></div></text-box><text-box variant='learningObjectives' name='node drain'><p>Drain a node</p></text-box><exercise name='cleanup'><p>Delete the namespace to clean up</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl delete namespace __NAME__</code></pre></div><p>Notice how get pod listing still \"uses\" the namespace</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get pod</code></pre></div><pre>\nNo resources found in __NAME__ namespace.\n</pre><p>You need to reset the namespace back to default</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl config set-context --current --namespace=default</code></pre></div><p>Will <code class=\"language-text\">get pod</code> now list default namespace?</p><p>see <a href=\"https://github.com/blendle/kns\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/blendle/kns</a> and <a href=\"https://github.com/ahmetb/kubectx\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/ahmetb/kubectx</a></p></exercise><exercise name='try delete namespace default'><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl delete ns default</code></pre></div><p>What happens?</p></exercise><exercise name='plenty of other pods'><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get pod --all-namespaces</code></pre></div><p>or</p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get pod -A</code></pre></div><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get pod --namespace kube-system</code></pre></div><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">kubectl get pod -n kube-system</code></pre></div></exercise><summary><ul>\n<li>pod is ~immutable unit of container orchestration</li>\n<li>kubectl run</li>\n<li>kubectl get events</li>\n<li>kubectl logs [—previous]</li>\n<li>kubectl exec</li>\n<li>kubectl port-forward</li>\n<li>kubectl set image</li>\n<li>kubectl cp</li>\n<li>kubectl delete</li>\n<li>kubectl -A | —all-namespaces</li>\n<li>kubectl -n | —namespace</li>\n</ul><p><a href=\"https://kubernetes.io/docs/reference/kubectl/docker-cli-to-kubectl/\" target=\"_blank\" rel=\"noopener noreferrer\">https://kubernetes.io/docs/reference/kubectl/docker-cli-to-kubectl/</a></p></summary></div>","frontmatter":{"path":"/part-0/5-pod","title":"Pod"},"fileAbsolutePath":"/Users/matti/dev/kubernetes-hy.github.io/data/part-0/5-pod.md"},"allPages":{"edges":[{"node":{"id":"13dd60c3-9be6-5a4b-ae4f-116e6dcffdb1","frontmatter":{"path":"/part-0/3-kubectl-basics","title":"kubectl basics"}}},{"node":{"id":"b1c47f2d-76e9-58d8-9a14-2b6132468171","frontmatter":{"path":"/frontmatter-guide","title":"Frontmatter-guide"}}},{"node":{"id":"12166a9a-6e11-5213-94d8-08c3f18bce09","frontmatter":{"path":"/sanasto","title":"Sanasto"}}},{"node":{"id":"24e8849f-09ad-5dc0-ada7-9ee5278ef27b","frontmatter":{"path":"/part-0","title":"Part 0"}}},{"node":{"id":"1cb09917-b0d2-558b-b2f2-86e195b30139","frontmatter":{"path":"/part-0/4-namespace","title":"Namespace"}}},{"node":{"id":"0521f0d3-f635-5905-a983-8a5d07967c76","frontmatter":{"path":"/part-0/1-kubernetes","title":"Kubernetes"}}},{"node":{"id":"a263867b-5ee2-59a1-b9cc-3ffa8e0b8965","frontmatter":{"path":"/part-0/5-pod","title":"Pod"}}},{"node":{"id":"8467a6ee-a4e0-5f79-92f4-8876c9a97f5d","frontmatter":{"path":"/part-0/2-kubectl-config","title":"kubectl config"}}},{"node":{"id":"9d9ca5cf-d405-50f5-b561-f857d2a77c76","frontmatter":{"path":"/","title":"Homepage"}}}]}},"pageContext":{}},"staticQueryHashes":["3294351120","994120085"]}