{"componentChunkName":"component---src-templates-course-content-template-js","path":"/part-1/3-loadbalancer","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Service"}]},{"type":"element","tagName":"exercise","properties":{"name":"service-lb"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The following mess is based on:"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://docs.aws.amazon.com/eks/latest/userguide/network-load-balancing.html","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://docs.aws.amazon.com/eks/latest/userguide/network-load-balancing.html"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.2/guide/service/annotations/","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.2/guide/service/annotations/"}]}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"whoami/service-lb.yml"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"apiVersion: v1\nkind: Service\nmetadata:\n  name: whoami-lb\n  namespace: __NAME__\n  annotations:\n    service.beta.kubernetes.io/aws-load-balancer-type: external\n    service.beta.kubernetes.io/aws-load-balancer-scheme: internet-facing\n    service.beta.kubernetes.io/aws-load-balancer-ip-address-type: dualstack\n    service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: ip\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-protocol: TCP\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-healthy-threshold: \"2\"\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-unhealthy-threshold: \"2\"\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-timeout: \"1\"\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-interval: \"10\"\n    service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: \"true\"\n    service.beta.kubernetes.io/aws-load-balancer-target-group-attributes: deregistration_delay.timeout_seconds=3,deregistration_delay.connection_termination.enabled=true,stickiness.enabled=false,load_balancing.cross_zone.enabled=true\nspec:\n  selector:\n    app: whoami\n  ports:\n    - port: 80\n      targetPort: 8000\n  type: LoadBalancer"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Service will target pods where label "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"app"}]},{"type":"text","value":" equals "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"whoami"}]}]},{"type":"element","tagName":"div","properties":{"className":["gatsby-highlight"],"dataLanguage":"console"},"children":[{"type":"element","tagName":"pre","properties":{"className":["language-console"]},"children":[{"type":"element","tagName":"code","properties":{"className":["language-console"]},"children":[{"type":"text","value":"spec:\n  selector:\n    app: whoami"}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"and apply. Check in Lens Network > Services"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"While waiting for AWS, test Lens service expose."}]}]},{"type":"element","tagName":"exercise","properties":{"name":"scale up"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Scale up, this time with Lens and check the load balancer"}]}]},{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"warning"},"children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Q: Am I charged for regional AWS data-transfer when I enable cross-zone load balancing in Network Load Balancer?"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A: Yes, you will be charged for regional data transfer between Availability Zones with Network Load Balancer when cross-zone load balancing is enabled. Check the charges in the data-transfer section at Amazon EC2 On-Demand Pricing page."}]}]},{"type":"element","tagName":"summary","properties":{},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Service of Type \"LoadBalancer\""}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Kubernetes is a standard until it's not"}]},{"type":"text","value":"\n"}]}]}]},"html":"<div><p>Service</p><exercise name='service-lb'><p>The following mess is based on:</p><ul>\n<li><a href=\"https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/\" target=\"_blank\" rel=\"noopener noreferrer\">https://kubernetes.io/docs/tasks/access-application-cluster/create-external-load-balancer/</a></li>\n<li><a href=\"https://docs.aws.amazon.com/eks/latest/userguide/network-load-balancing.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://docs.aws.amazon.com/eks/latest/userguide/network-load-balancing.html</a></li>\n<li><a href=\"https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.2/guide/service/annotations/\" target=\"_blank\" rel=\"noopener noreferrer\">https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.2/guide/service/annotations/</a></li>\n</ul><p><strong>whoami/service-lb.yml</strong></p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">apiVersion: v1\nkind: Service\nmetadata:\n  name: whoami-lb\n  namespace: __NAME__\n  annotations:\n    service.beta.kubernetes.io/aws-load-balancer-type: external\n    service.beta.kubernetes.io/aws-load-balancer-scheme: internet-facing\n    service.beta.kubernetes.io/aws-load-balancer-ip-address-type: dualstack\n    service.beta.kubernetes.io/aws-load-balancer-nlb-target-type: ip\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-protocol: TCP\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-healthy-threshold: &quot;2&quot;\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-unhealthy-threshold: &quot;2&quot;\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-timeout: &quot;1&quot;\n    service.beta.kubernetes.io/aws-load-balancer-healthcheck-interval: &quot;10&quot;\n    service.beta.kubernetes.io/aws-load-balancer-cross-zone-load-balancing-enabled: &quot;true&quot;\n    service.beta.kubernetes.io/aws-load-balancer-target-group-attributes: deregistration_delay.timeout_seconds=3,deregistration_delay.connection_termination.enabled=true,stickiness.enabled=false,load_balancing.cross_zone.enabled=true\nspec:\n  selector:\n    app: whoami\n  ports:\n    - port: 80\n      targetPort: 8000\n  type: LoadBalancer</code></pre></div><p>Service will target pods where label <code class=\"language-text\">app</code> equals <code class=\"language-text\">whoami</code></p><div class=\"gatsby-highlight\" data-language=\"console\"><pre class=\"language-console\"><code class=\"language-console\">spec:\n  selector:\n    app: whoami</code></pre></div><p>and apply. Check in Lens Network > Services</p><p>While waiting for AWS, test Lens service expose.</p></exercise><exercise name='scale up'><p>Scale up, this time with Lens and check the load balancer</p></exercise><text-box variant=\"learningObjectives\" name=\"warning\"><p>Q: Am I charged for regional AWS data-transfer when I enable cross-zone load balancing in Network Load Balancer?</p><p>A: Yes, you will be charged for regional data transfer between Availability Zones with Network Load Balancer when cross-zone load balancing is enabled. Check the charges in the data-transfer section at Amazon EC2 On-Demand Pricing page.</p></text-box><summary><ul>\n<li>Service of Type \"LoadBalancer\"</li>\n<li>Kubernetes is a standard until it's not</li>\n</ul></summary></div>","frontmatter":{"path":"/part-1/3-loadbalancer","title":"LoadBalancer"},"fileAbsolutePath":"/Users/matti/dev/kubernetes-hy.github.io/data/part-1/3-loadbalancer.md"},"allPages":{"edges":[{"node":{"id":"b1c47f2d-76e9-58d8-9a14-2b6132468171","frontmatter":{"path":"/frontmatter-guide","title":"Frontmatter-guide"}}},{"node":{"id":"12166a9a-6e11-5213-94d8-08c3f18bce09","frontmatter":{"path":"/sanasto","title":"Sanasto"}}},{"node":{"id":"24e8849f-09ad-5dc0-ada7-9ee5278ef27b","frontmatter":{"path":"/part-0","title":"Part 0"}}},{"node":{"id":"8467a6ee-a4e0-5f79-92f4-8876c9a97f5d","frontmatter":{"path":"/part-0/2-kubectl-config","title":"kubectl config"}}},{"node":{"id":"13dd60c3-9be6-5a4b-ae4f-116e6dcffdb1","frontmatter":{"path":"/part-0/3-kubectl-basics","title":"kubectl basics"}}},{"node":{"id":"0521f0d3-f635-5905-a983-8a5d07967c76","frontmatter":{"path":"/part-0/1-kubernetes","title":"Kubernetes"}}},{"node":{"id":"a263867b-5ee2-59a1-b9cc-3ffa8e0b8965","frontmatter":{"path":"/part-0/5-pod","title":"Pod"}}},{"node":{"id":"b329e1eb-4475-517c-aacc-00490d0d2839","frontmatter":{"path":"/part-1","title":"Part 1"}}},{"node":{"id":"f2603f2a-7d1c-577c-b6ef-cff715589ff2","frontmatter":{"path":"/part-1/1-first-deploy","title":"First Deploy"}}},{"node":{"id":"bd25e984-94a9-534b-8527-3869b6c77792","frontmatter":{"path":"/part-1/3-loadbalancer","title":"LoadBalancer"}}},{"node":{"id":"1cb09917-b0d2-558b-b2f2-86e195b30139","frontmatter":{"path":"/part-0/4-namespace","title":"Namespace"}}},{"node":{"id":"1b008c97-c439-59e0-aae1-3f90dbdd3f26","frontmatter":{"path":"/part-1/2-second-deploy","title":"Second Deploy"}}},{"node":{"id":"c641591d-97e5-5c9c-a217-783adff04421","frontmatter":{"path":"/part-1/4-clusterip","title":"ClusterIP"}}},{"node":{"id":"9d9ca5cf-d405-50f5-b561-f857d2a77c76","frontmatter":{"path":"/","title":"Homepage"}}}]}},"pageContext":{}},"staticQueryHashes":["3294351120","994120085"]}